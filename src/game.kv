#:import font_config frontend.shared.styles.font_config
#:import K_PRIMARY frontend.shared.styles.K_PRIMARY
#:import K_SECONDARY frontend.shared.styles.K_SECONDARY
#:import SCREEN_PADDING frontend.shared.styles.SCREEN_PADDING
#:import SECTION_SPACING frontend.shared.styles.SECTION_SPACING
#:import WIDGET_SPACING frontend.shared.styles.WIDGET_SPACING

<PrimaryButton@Button>:
    background_normal: ''
    background_color: K_PRIMARY

<SecondaryButton@Button>:
    background_normal: ''
    background_color: K_SECONDARY

<WelcomeScreen>:
    BoxLayout:
        orientation: 'vertical'
        padding: [SCREEN_PADDING, SCREEN_PADDING, SCREEN_PADDING, SCREEN_PADDING]
        spacing: SECTION_SPACING
        
        # Header
        BoxLayout:
            size_hint_y: 0.2
            Label:
                text: "Willkommen zum Myjongg Calculator!"
                font_size: font_config.font_size_big
                halign: 'center'
                valign: 'middle'
                text_size: self.size

        # Instructions
        BoxLayout:
            size_hint_y: 0.15
            Label:
                text: "Bitte wählen Sie einen Ordner für die Rundenaufzeichnung:"
                font_size: font_config.font_size_medium
                halign: 'center'
                valign: 'middle'
                text_size: self.size

        # Folder info
        BoxLayout:
            size_hint_y: 0.1
            Label:
                text: root.folder_info
                font_size: font_config.font_size_medium
                halign: 'center'
                valign: 'middle'
                text_size: self.size
                shorten: True
                shorten_from: 'right'
                padding: [WIDGET_SPACING, 0]
                markup: True

        # Spacer
        Widget:
            size_hint_y: 0.2

        # Buttons
        BoxLayout:
            size_hint_y: 0.35
            orientation: 'vertical'
            spacing: WIDGET_SPACING
            
            SecondaryButton:
                text: "Rundenordner auswählen/erstellen"
                font_size: font_config.font_size_medium
                on_release: root.select_folder()
            
            SecondaryButton:
                text: f"Verwende {root.get_default_folder_name()}"
                font_size: font_config.font_size_medium
                on_release: root.use_default_folder()
            
            PrimaryButton:
                text: "Weiter"
                font_size: font_config.font_size_medium
                disabled: not root.can_proceed
                on_release: root.proceed_to_start_screen()

<StartScreen>:
    BoxLayout:
        orientation: 'vertical'
        padding: [SCREEN_PADDING, SCREEN_PADDING, SCREEN_PADDING, SCREEN_PADDING]
        spacing: SECTION_SPACING
        
        # Header
        BoxLayout:
            size_hint_y: 0.15
            Label:
                text: "Neue Runde neues Glück!"
                font_size: font_config.font_size_big

        # Explanation Label
        Label:
            size_hint_y: 0.1
            text: "Namen der Spieler eingeben:"
            font_size: font_config.font_size_medium

        # Body
        BoxLayout:
            id: player_inputs_container
            orientation: 'vertical'
            size_hint_y: 0.60

        # Footer
        BoxLayout:
            size_hint_y: 0.15
            PrimaryButton:
                text: "Runde starten"
                font_size: font_config.font_size_medium
                on_release: root.start_game(self)

<ScoreboardScreen>:
    BoxLayout:
        orientation: 'vertical'
        padding: [SCREEN_PADDING, SCREEN_PADDING, SCREEN_PADDING, SCREEN_PADDING]
        spacing: SECTION_SPACING
        
        # Header
        BoxLayout:
            size_hint_y: 0.15
            Label:
                text: f"Punktestand nach Spiel {root.current_round_number - 1}"
                font_size: font_config.font_size_big

        # Body
        BoxLayout:
            orientation: 'vertical'
            size_hint_y: 0.70
            GridLayout:
                id: scoreboard
                cols: 3
                spacing: WIDGET_SPACING
                row_default_height: self.parent.height * 0.15

        # Footer
        BoxLayout:
            size_hint_y: 0.15
            PrimaryButton:
                id: points_button
                text: "Punkte eingeben"
                font_size: font_config.font_size_medium
                on_release: 
                    root.manager.transition.direction = 'left'
                    root.go_to_add_points(self)

<AddPointsScreen>:
    BoxLayout:
        orientation: 'vertical'
        padding: [SCREEN_PADDING, SCREEN_PADDING, SCREEN_PADDING, SCREEN_PADDING]
        spacing: SECTION_SPACING
        
        # Header
        BoxLayout:
            size_hint_y: 0.15
            orientation: 'vertical'
            Label:
                text: f"Eingabe für Spiel {root.current_round_number}"
                font_size: font_config.font_size_big

        # Table Header
        GridLayout:
            size_hint_y: 0.1
            cols: 4
            Label:
                text: "Spieler"
                font_size: font_config.font_size_medium
            Label:
                text: "Gewinner"
                font_size: font_config.font_size_medium
            Label:
                text: "Punkte"
                font_size: font_config.font_size_medium
            Label:
                text: "# Verdopplungen"
                font_size: font_config.font_size_medium

        # Body
        BoxLayout:
            id: players_layout
            orientation: 'vertical'
            size_hint_y: 0.60

        # Footer
        BoxLayout:
            id: buttons_layout
            size_hint_y: 0.15
            orientation: 'horizontal'
            spacing: WIDGET_SPACING
            SecondaryButton:
                id: back_button
                text: "Zurück"
                font_size: font_config.font_size_medium
                disabled: root.first_time
                on_release:
                    root.manager.transition.direction = 'right'
                    root.manager.current = 'scoreboard'
            PrimaryButton:
                text: "Punkte berechnen"
                font_size: font_config.font_size_medium
                on_release: root.submit_points()

<RoundSummaryScreen>:
    BoxLayout:
        orientation: 'vertical'
        padding: [SCREEN_PADDING, SCREEN_PADDING, SCREEN_PADDING, SCREEN_PADDING]
        spacing: SECTION_SPACING
        
        # Header
        BoxLayout:
            size_hint_y: 0.15
            Label:
                text: f"Übersicht Spiel {root.current_round_number - 1}"
                font_size: font_config.font_size_big

        # Table Header
        GridLayout:
            size_hint_y: 0.1
            cols: 3
            Label:
                text: "Spieler"
                font_size: font_config.font_size_medium
            Label:
                text: "Spielpunkte"
                font_size: font_config.font_size_medium
            Label:
                text: "Punkteänderung"
                font_size: font_config.font_size_medium

        # Body
        BoxLayout:
            id: summary_layout
            orientation: 'vertical'
            size_hint_y: 0.60

        # Footer
        BoxLayout:
            size_hint_y: 0.15
            PrimaryButton:
                id: confirm_button
                text: "Punkte anwenden"
                font_size: font_config.font_size_medium
                on_release: root.confirm_points()

<GameOverScreen>:
    BoxLayout:
        orientation: 'vertical'
        padding: [SCREEN_PADDING, SCREEN_PADDING, SCREEN_PADDING, SCREEN_PADDING]
        spacing: SECTION_SPACING
        
        # Header
        BoxLayout:
            size_hint_y: 0.15
            Label:
                text: root.winner_text
                font_size: font_config.font_size_big
                bold: True

        # Body
        BoxLayout:
            orientation: 'vertical'
            size_hint_y: 0.70
            GridLayout:
                id: scoreboard
                cols: 3
                spacing: WIDGET_SPACING
                row_default_height: self.parent.height * 0.15

        # Footer
        BoxLayout:
            size_hint_y: 0.15
            PrimaryButton:
                text: "Rundenauswertung"
                font_size: font_config.font_size_medium
                on_release: root.proceed_to_save_game()

<SaveGameScreen>:
    BoxLayout:
        orientation: 'vertical'
        padding: [SCREEN_PADDING, SCREEN_PADDING, SCREEN_PADDING, SCREEN_PADDING]
        spacing: SECTION_SPACING

        # Body
        BoxLayout:
            id: save_container
            orientation: 'vertical'
            size_hint_y: 0.8

        # Footer
        BoxLayout:
            size_hint_y: 0.15
            PrimaryButton:
                id: save_button
                text: 'Runde speichern'
                font_size: font_config.font_size_medium
                size_hint_y: None
                height: self.parent.height * 0.8
                on_release: root.save_game()

<FinalScreen>:
    BoxLayout:
        orientation: 'vertical'
        padding: [SCREEN_PADDING, SCREEN_PADDING, SCREEN_PADDING, SCREEN_PADDING]
        spacing: SECTION_SPACING
        
        # Body
        BoxLayout:
            id: final_container
            orientation: 'vertical'
            size_hint_y: 0.75
        
        # Footer with action buttons
        BoxLayout:
            size_hint_y: 0.15
            orientation: 'horizontal'
            spacing: WIDGET_SPACING
            
            SecondaryButton:
                text: "Öffne Rundenordner"
                font_size: font_config.font_size_medium
                size_hint_y: None
                height: self.parent.height * 0.8
                on_release: root.open_game_folder()
            
            PrimaryButton:
                text: "Neue Runde"
                font_size: font_config.font_size_medium
                size_hint_y: None
                height: self.parent.height * 0.8
                on_release: root.start_new_game()
